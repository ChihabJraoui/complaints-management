function readImage(e){var t=new FileReader;t.addEventListener("load",function(){var e=new Image;e.addEventListener("load",function(){e.src=t.result})}),t.readAsDataURL(e)}function disableButton(e){$(e).prepend('<i class="fa fa-spinner fa-spin"></i>'),$(e).prop("disabled",!0)}function enableButton(e){$(e).find("i").remove(),$(e).prop("disabled",!1)}function configController(e,t){e.data={},e.loading=!0,e.getSettings=function(){t({method:"GET",url:"/api/config",headers:{"X-CSRF-TOKEN":window.app.csrf_token}}).then(function(t){e.loading=!1,e.data=t.data})},e.getSettings(),e.showModal=function(){$("#modal-photo").modal("show")},e.submit=function(t){$(t.srcElement).prepend('<i class="fa fa-spinner fa-spin"></i>'),$(t.srcElement).prop("disabled",!0),e.data.pictures=$("#pictures")[0].files,Picture.store(e.data).then(function(e){$(t.srcElement).find("i").remove(),$(t.srcElement).prop("disabled",!1)})},e["delete"]=function(e){}}function galleryController(e,t){e.data={},e.errors="",e.formValid=!1,e.loading=!0,e.init=function(){e.data={pictures:[]},$("#pictures").val("")},e.init(),e.getPictures=function(){e.loading=!0,t.get().then(function(t){e.loading=!1,e.pictures=t.data})},e.getPictures(),e.showModal=function(){e.init(),e.frmPicture.$setPristine(),e.frmPicture.$setUntouched(),$("#modal-photo").modal("show")},$("#pictures").on("change",function(){e.errors="";var t=$(this)[0].files;if(t&&t[0])for(var i=0;i<t.length;i++){var n=t[i];/\.(png|jpg|jpeg)$/i.test(n.name)?n.size<=image_size_limit?(e.data.pictures.push(n),e.formValid=!0,e.$apply(),$("<p />",{"class":"text-success",html:'<i class="fa fa-check"></i> '+n.name+" - "+Math.round(n.size/1024)+" Kb <br>"}).appendTo('form[name="frmPicture"]')):$("<p />",{"class":"text-danger",html:'<i class="fa fa-times"></i> '+n.name+" - "+Math.round(n.size/1024)+" Kb <br>Taille Maximum: 2Mo."}).appendTo('form[name="frmPicture"]'):$("<p />",{"class":"text-danger",html:'<i class="fa fa-times"></i> '+n.name+" - "+Math.round(n.size/1024)+" Kb <br>Veuillez choisir un fichier de type Image (png, jpg, jpeg)."}).appendTo('form[name="frmPicture"]')}}),e.submit=function(i){disableButton(i.currentTarget),t.store(e.data).then(function(t){0==t.data.error&&(e.getPictures(),$("#modal-photo").modal("hide"),enableButton(i.currentTarget))})},e["delete"]=function(i){var n=new jBox("Confirm",{content:"Voules-vous vraiment supprimer cette Photo ?",confirmButton:"Oui",cancelButton:"Non",confirm:function(){t["delete"](i).then(function(t){e.getPictures()},function(e){})}});n.open()}}function pricingController(e,t){e.data={},e.modal={},e.loading=!0,e._init=function(){e.data.pricing={is_with_guide:0,is_with_dinner:0,is_half_day:0,is_round_trip:0}},e._init(),e.getPricings=function(){e.loading=!0,t.getPricings().then(function(t){e.pricings=t.data,e.loading=!1})},e.getPricings(),e.showModal=function(t){e._init(),e.frmPricing.$setPristine(),e.frmPricing.$setUntouched(),null==t?(e.modal.title="Nouveau Tarif",e.modal.type="new"):(e.modal.title="Modifier tarif : ",e.modal.type="edit",e.data.pricing.id=t.id,e.data.pricing.from=t.from,e.data.pricing.to=t.to,e.data.pricing.description=t.description,e.data.pricing.price=t.price,e.data.pricing.is_with_guide=t.is_with_guide,e.data.pricing.is_with_dinner=t.is_with_dinner,e.data.pricing.is_half_day=t.is_half_day,e.data.pricing.is_round_trip=t.is_round_trip),$("#modal-pricings").modal("show")},e.submit=function(i){$(i.currentTarget).prepend('<i class="fa fa-spinner fa-spin"></i>'),$(i.currentTarget).prop("disabled",!0),"new"==e.modal.type?t.store(e.data.pricing).then(function(t){$("#modal-pricings").modal("hide"),e.getPricings(),$(i.currentTarget).find("i").remove(),$(i.currentTarget).prop("disabled",!1)}):t.update(e.data.pricing).then(function(t){$("#modal-pricings").modal("hide"),e.getPricings(),$(i.currentTarget).find("i").remove(),$(i.currentTarget).prop("disabled",!1)})},e["delete"]=function(i){var n=new jBox("Confirm",{content:"Voules-vous vraiment supprimer cet Tarif ?",confirmButton:"Oui",cancelButton:"Non",confirm:function(){t["delete"](i).then(function(t){e.getPricings()},function(e){})}});n.open()}}function profileController(e,t){e.data={},e.loading=!0,e.getUser=function(){t.get().then(function(t){e.loading=!1,e.data=t.data})},e.getUser(),e.showModal=function(){$("#modal-photo").modal("show")},e.submit=function(t){$(t.srcElement).prepend('<i class="fa fa-spinner fa-spin"></i>'),$(t.srcElement).prop("disabled",!0),e.data.pictures=$("#pictures")[0].files,Picture.store(e.data).then(function(e){$(t.srcElement).find("i").remove(),$(t.srcElement).prop("disabled",!1)})},e["delete"]=function(e){}}function reviewController(e,t){e.data={},e.modal={},e.loading=!0,e.getReviews=function(){t.getReviews().then(function(t){e.reviews=t.data.reviews,e.reviewsWait=t.data.reviewsWait,e.loading=!1})},e.getReviews(),e.showModal=function(t){e._init(),e.frmTour.$setPristine(),e.frmTour.$setUntouched(),null==t?(e.modal.title="Nouveau Tour",e.modal.type="new"):(e.modal.title="Modifier : "+t.title,e.modal.type="edit",e.data.tour.id=t.id,e.data.tour.title=t.title,e.data.tour.type=t.type,e.data.tour.description_en=t.description_en,e.data.tour.description_fr=t.description_fr,e.data.tour.duration=t.duration,e.data.tour.depart=t.depart,e.data.tour.includes_en=t.includes_en,e.data.tour.includes_fr=t.includes_fr,e.data.tour.price=t.price),$("#modal-tours").modal("show")},e.submit=function(e){$(e.srcElement).prepend('<i class="fa fa-spinner fa-spin"></i>&nbsp;'),$(e.srcElement).prop("disabled",!0)}}function toursController(e,t){e.data={},e.modal={},e.loading=!0,e._init=function(){e.data.tour={type:0,duration:0,price:0,is_air_conditioned:0,is_mule:0,is_meals:0,is_guide:0,is_driver:0}},e._init(),e.getTours=function(){e.loading=!0,t.getTours().then(function(t){e.tours=t.data,e.loading=!1})},e.getTours(),e.showModal=function(t){e.data.tour={},e._init(),e.frmTour.$setPristine(),e.frmTour.$setUntouched(),null==t?(e.modal.title="Nouveau Tour",e.modal.type="new"):(e.modal.title="Modifier : "+t.title,e.modal.type="edit",e.data.tour.id=t.id,e.data.tour.type=t.type,e.data.tour.title=t.title,e.data.tour.description_en=t.description_en,e.data.tour.description_fr=t.description_fr,e.data.tour.duration=t.duration,e.data.tour.depart=t.depart,e.data.tour.price=t.price,e.data.tour.is_air_conditioned=t.is_air_conditioned,e.data.tour.is_mule=t.is_mule,e.data.tour.is_meals=t.is_meals,e.data.tour.is_guide=t.is_guide,e.data.tour.is_driver=t.is_driver),$("#modal-tours").modal("show")},e.submit=function(i){$(i.currentTarget).prepend('<i class="fa fa-spinner fa-spin"></i>'),$(i.currentTarget).prop("disabled",!0),e.data.tour.cover=$("#cover-file")[0].files[0],"new"==e.modal.type?t.store(e.data.tour).then(function(t){$("#modal-tours").modal("hide"),e.getTours(),$(i.currentTarget).find("i").remove(),$(i.currentTarget).prop("disabled",!1)}):t.update(e.data.tour).then(function(t){$("#modal-tours").modal("hide"),e.getTours(),$(i.currentTarget).find("i").remove(),$(i.currentTarget).prop("disabled",!1)})},e["delete"]=function(i){var n=new jBox("Confirm",{content:"Voules-vous vraiment supprimer cet Tour ?",confirmButton:"Oui",cancelButton:"Non",confirm:function(){t["delete"](i).then(function(t){e.getTours()})}});n.open()}}function pictureService(e){return{get:function(){return e({method:"GET",url:"/gallery/get",headers:{"X-CSRF-TOKEN":window.app.csrf_token}})},store:function(t){var i=new FormData;return $.each(t.pictures,function(e,t){i.append("pictures[]",t)}),e({method:"POST",url:"/gallery",data:i,headers:{"Content-Type":void 0,"X-CSRF-TOKEN":window.app.csrf_token},transformRequest:angular.identity})},"delete":function(t){return e({method:"DELETE",url:"/gallery/"+t,headers:{"X-CSRF-TOKEN":window.app.csrf_token}})}}}function pricingService(e){return{getPricings:function(){return e({method:"GET",url:"/pricings/all",headers:{"X-CSRF-TOKEN":window.app.csrf_token}})},store:function(t){return e({method:"POST",url:"/pricings",data:$.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":window.app.csrf_token}})},update:function(t){return e({method:"POST",url:"/pricings/"+t.id,data:$.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":window.app.csrf_token}})},"delete":function(t){return e({method:"DELETE",url:"/pricings/"+t,headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":window.app.csrf_token}})}}}function reviewService(e){return{getReviews:function(){return e({method:"GET",url:"/reviews/get",headers:{"X-CSRF-TOKEN":window.app.csrf_token}})},store:function(t){return e({method:"POST",url:"/tours",data:$.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":window.app.csrf_token}})},update:function(t){return e({method:"PUT",url:"/tours/"+t.id,data:$.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":window.app.csrf_token}})}}}function tourService(e){return{getTours:function(){return e({method:"GET",url:"/tours/all",headers:{"X-CSRF-TOKEN":window.app.csrf_token}})},store:function(t){var i=new FormData;return i.append("type",t.type),i.append("title",t.title),i.append("description_en",t.description_en),i.append("description_fr",t.description_fr),i.append("duration",t.duration),i.append("depart",t.depart),i.append("price",t.price),i.append("cover",t.cover),i.append("is_air_conditioned",t.is_air_conditioned),i.append("is_mule",t.is_mule),i.append("is_meals",t.is_meals),i.append("is_guide",t.is_guide),i.append("is_driver",t.is_driver),e({method:"POST",url:"/tours",data:i,headers:{"Content-Type":void 0,"X-CSRF-TOKEN":window.app.csrf_token},transformRequest:angular.identity})},update:function(t){var i=new FormData;return i.append("id",t.id),i.append("type",t.type),i.append("title",t.title),i.append("description_en",t.description_en),i.append("description_fr",t.description_fr),i.append("duration",t.duration),i.append("depart",t.depart),i.append("price",t.price),i.append("cover",t.cover),i.append("is_air_conditioned",t.is_air_conditioned),i.append("is_mule",t.is_mule),i.append("is_meals",t.is_meals),i.append("is_guide",t.is_guide),i.append("is_driver",t.is_driver),e({method:"POST",url:"/tours/"+t.id,data:i,headers:{"Content-Type":void 0,"X-CSRF-TOKEN":window.app.csrf_token},transformRequest:angular.identity})},"delete":function(t){return e({method:"DELETE",url:"/tours/"+t,headers:{"X-CSRF-TOKEN":window.app.csrf_token}})}}}function userService(e){return{get:function(){return e({method:"GET",url:"/profile/get-user",headers:{"X-CSRF-TOKEN":window.app.csrf_token}})},store:function(t){var i=new FormData;return $.each(t.pictures,function(e,t){i.append("pictures[]",t)}),e({method:"POST",url:"/gallery",data:i,headers:{"Content-Type":void 0,"X-CSRF-TOKEN":window.app.csrf_token},transformRequest:angular.identity})}}}var image_size_limit=4194304;window.app={csrf_token:$('meta[name="csrf-token"]').attr("content")},$(document).ready(function(){$("#btn-toggle-sidebar").click(function(){$(".site-sidebar-overlay").fadeIn(400),$(".site-sidebar").addClass("is-extended")}),$(".site-sidebar-overlay").click(function(){$(".site-sidebar").removeClass("is-extended"),$(this).fadeOut(400)}),$("body").tooltip({selector:'[data-toggle="tooltip"]'});var e=$("#tour-images");e.length&&e.EasyUp({url:""}),$("#toursPie").length});var angularAdmin=angular.module("Admin",[]);angularAdmin.directive("ngBackground",function(){return{restrict:"A",link:function(e,t,i){$(t).css("background-image","url("+i.ngBackground+")")}}}),angularAdmin.directive("ngTimePicker",function(){return{require:"?ngModel",restrict:"A",link:function(e,t,i,n){$(t).datetimepicker({defaultTime:"08:00",formatTime:"H:i",datepicker:!1,inline:!0,allowTimes:["06:00","07:00","08:00","09:00","10:00","11:00","12:00"],onSelectTime:function(e){n.$setViewValue(e.dateFormat("H:i"))}})}}}),angularAdmin.run(["$rootScope",function(e){}]),angularAdmin.controller("ConfigController",["$scope","$http",configController]),angularAdmin.controller("GalleryController",["$scope","Picture",galleryController]),angularAdmin.controller("PricingsController",["$scope","Pricing",pricingController]),angularAdmin.controller("ProfileController",["$scope","User",profileController]),angularAdmin.controller("ReviewsController",["$scope","Review",reviewController]),angularAdmin.controller("ToursController",["$scope","Tour",toursController]),angularAdmin.service("Picture",["$http",pictureService]),angularAdmin.service("Pricing",["$http",pricingService]),angularAdmin.service("Review",["$http",reviewService]),angularAdmin.service("Tour",["$http",tourService]),angularAdmin.service("User",["$http",userService]);